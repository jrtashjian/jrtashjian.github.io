<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="x-ua-compatible" content="ie=edge">

        <title>Validate terminal command in PHP | JR Tashjian</title>
        <meta name="description" content="Senior Software Engineer">

        <meta property="og:title" content="Validate terminal command in PHP | JR Tashjian"/>
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://jrtashjian.com/2010/11/validate-terminal-command-in-php"/>
        <meta property="og:description" content="Senior Software Engineer" />
        <meta property="og:image" content="https://jrtashjian.com/assets/images/about-page.webp" />

        <!-- Twitter Meta Tags -->
        <meta name="twitter:card" content="summary_large_image">
        <meta property="twitter:domain" content="jrtashjian.com">
        <meta property="twitter:url" content="https://jrtashjian.com">
        <meta name="twitter:title" content="Validate terminal command in PHP | JR Tashjian">
        <meta name="twitter:description" content="Senior Software Engineer">
        <meta name="twitter:image" content="https://jrtashjian.com/assets/images/about-page.webp">


        <link rel="canonical" href="https://jrtashjian.com/2010/11/validate-terminal-command-in-php">
        <link rel="icon" href="/assets/images/favicon-32x32.jpg" sizes="32x32" />
        <link rel="icon" href="/assets/images/favicon-192x192.jpg" sizes="192x192" />
        <link rel="apple-touch-icon" href="/assets/images/favicon-180x180.jpg" />
        <meta name="msapplication-TileImage" content="/assets/images/favicon-270x270.jpg" />

                <script defer data-domain="jrtashjian.com" src="https://plausible.jrtashjian.com/js/plausible.js"></script>
        
        <link rel="stylesheet" href="/assets/build/css/main.css?id=4e5d00fa5633ea52d10317e19903d42b">
        <script defer src="/assets/build/js/main.js?id=70f6d1d6eeef91fcbf04b0be8a530710"></script>

        <link rel="alternate" type="application/rss+xml" title="All Posts by JR Tashjian (The RSS Feed)" href="https://jrtashjian.com/feed.xml" />
    </head>
    <body class="bg-white dark:bg-black text-black dark:text-white font-mono leading-relaxed px-4">
        <div class="mx-auto max-w-prose">

            <header class="flex flex-wrap mb-8 py-8 border-b-8 border-black dark:border-white" role="banner">
                <a href="/" title="JR Tashjian home" class="my-2">
                    <h1 class="font-bold">~/jrtashjian</h1>
                </a>
                <div class="h-card flex ml-auto mr-0">
                    <a href="https://talos.link/@jrtashjian" rel="me" class="u-url inline-flex ml-3 my-2">
                        <svg class="mr-2 fill-current" width="24" height="24" view-box="0 0 24 24" version="1.1">
                            <path d="M23.193 7.879c0-5.206-3.411-6.732-3.411-6.732C18.062.357 15.108.025 12.041 0h-.076c-3.068.025-6.02.357-7.74 1.147 0 0-3.411 1.526-3.411 6.732 0 1.192-.023 2.618.015 4.129.124 5.092.934 10.109 5.641 11.355 2.17.574 4.034.695 5.535.612 2.722-.15 4.25-.972 4.25-.972l-.09-1.975s-1.945.613-4.129.539c-2.165-.074-4.449-.233-4.799-2.891a5.499 5.499 0 0 1-.048-.745s2.125.52 4.817.643c1.646.075 3.19-.097 4.758-.283 3.007-.359 5.625-2.212 5.954-3.905.517-2.665.475-6.507.475-6.507zm-4.024 6.709h-2.497V8.469c0-1.29-.543-1.944-1.628-1.944-1.2 0-1.802.776-1.802 2.312v3.349h-2.483v-3.35c0-1.536-.602-2.312-1.802-2.312-1.085 0-1.628.655-1.628 1.944v6.119H4.832V8.284c0-1.289.328-2.313.987-3.07.68-.758 1.569-1.146 2.674-1.146 1.278 0 2.246.491 2.886 1.474L12 6.585l.622-1.043c.64-.983 1.608-1.474 2.886-1.474 1.104 0 1.994.388 2.674 1.146.658.757.986 1.781.986 3.07v6.304z" />
                        </svg>
                        Mastodon
                    </a>
                    <a href="mailto:hello@jrtashjian.com" class="u-email inline-flex ml-3 my-2">
                        <svg class="mr-2 fill-current" width="24" height="24" view-box="0 0 24 24" version="1.1">
                            <path d="M20,4H4C2.895,4,2,4.895,2,6v12c0,1.105,0.895,2,2,2h16c1.105,0,2-0.895,2-2V6C22,4.895,21.105,4,20,4z M20,8.236l-8,4.882 L4,8.236V6h16V8.236z" />
                        </svg>
                        Email
                    </a>
                </div>
            </header>

            <main role="main">
                	<article class="h-entry">
		<header>
			<h1 class="p-name">Validate terminal command in PHP</h1>
			<time class="dt-published mr-3" datetime="2010-11-08T19:00:00-05:00" title="Published on November 9, 2010">November 9, 2010</time>
			<a class="p-author h-card sr-only" href="http://jrtashjian.com">JR Tashjian</a>
		</header>

		
		<div class="e-content">
			<p>Testing if a function exists in PHPÂ is easy. Testing if a command exists on the system is also easy. I've never really run into the problem of having to create a compatibility suite script to make sure my PHP script will run without trouble. Simple things like checking the version of PHP installed or the version of MySQL are straightforward. This time though, I needed to make sure a command line program existed on the system which I invoke using <a href="http://php.net/function.exec"><code>exec()</code></a>. First and foremost, we need to check that <code>exec()</code> exists and we can use it. If it does, we then need to use it to execute a command on the server which will output the path to our command. I will be testing for <code>tar</code> in the example.</p>

<pre><code>if ( function_exists( 'exec' ) ) {
    // send test command to system
    exec( 'command -v tar &gt;&amp; /dev/null &amp;&amp; echo "Found" || echo "Not Found"', $output );

    if ( $output[0] == "Found" ) {
        // command is available
        return TRUE;
    } else {
        // command is unavailable
        return FALSE;
    }
}
</code></pre>

<p>Our focus will be this line:</p>

<pre><code>exec( 'command -v tar &gt;&amp; /dev/null &amp;&amp; echo "Found" || echo "Not Found"', $output );
</code></pre>

<p>In the first part of the command we will run <code>command</code> with the <code>-v</code> option. The <code>-v</code> option causes the output of the <code>_command_</code> to be displayed or return zero if the <code>_command_</code> is not found. Here's a short description of the command:</p>

<pre><code>SYNTAX
    command [-pVv] _command_ [arguments ...]
OPTIONS
    -P  Use a default path
    -v  Verbose
    -V  More verbose
</code></pre>

<p>The next part of the command we use <code>&gt;&amp;</code> which is a metacharacter in Unix which tells the command to redirect the standard output and standard error. Which in this case, we redirect the output to a file <code>/dev/null</code>. We do this because we want to handle the response of the command with the last part. The last part of the command we use <code>&amp;&amp;</code> which is another metacharacter which tells Unix to execute the following command only if the preceding command succeeds. We also use the <code>||</code> metacharacter which tells Unix to execute the following command if the preceding command fails. To understand it better, it's just like writing an <code>if-then-else</code> statement:</p>

<pre><code>If( command -v tar &gt;&amp; /dev/null ) Then
    echo "Found"
Else
    echo "Not Found"
End If
</code></pre>

<p>Now we need to bring the response back to PHP. We do that with the second parameter of <code>exec();</code> <code>$output</code>. Every line of output from the command will be returned in <code>$output</code> as an array which we can then run our conditional against. Short, simple, easy little command. Just replace <code>tar</code> with the command you'd like to check for. You could even take the code and place it into a function to make it easily reusable.</p>
		</div>
	</article>
            </main>

            <footer class="flex justify-end mt-8 py-8 border-t-8 border-black dark:border-white" role="contentinfo">
                Copyright (c) 2022 JR Tashjian
            </footer>
        </div>
    </body>
</html>
