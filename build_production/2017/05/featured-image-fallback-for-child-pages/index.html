<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="x-ua-compatible" content="ie=edge">

        <title>Featured Image Fallback for Child Pages | JR Tashjian</title>
        <meta name="description" content="Senior Software Engineer">

        <meta property="og:title" content="Featured Image Fallback for Child Pages | JR Tashjian"/>
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://jrtashjian.com/2017/05/featured-image-fallback-for-child-pages"/>
        <meta property="og:description" content="Senior Software Engineer" />
        <meta property="og:image" content="https://jrtashjian.com/assets/images/about-page.webp" />

        <!-- Twitter Meta Tags -->
        <meta name="twitter:card" content="summary_large_image">
        <meta property="twitter:domain" content="jrtashjian.com">
        <meta property="twitter:url" content="https://jrtashjian.com">
        <meta name="twitter:title" content="Featured Image Fallback for Child Pages | JR Tashjian">
        <meta name="twitter:description" content="Senior Software Engineer">
        <meta name="twitter:image" content="https://jrtashjian.com/assets/images/about-page.webp">


        <link rel="canonical" href="https://jrtashjian.com/2017/05/featured-image-fallback-for-child-pages">
        <link rel="icon" href="/assets/images/favicon-32x32.jpg" sizes="32x32" />
        <link rel="icon" href="/assets/images/favicon-192x192.jpg" sizes="192x192" />
        <link rel="apple-touch-icon" href="/assets/images/favicon-180x180.jpg" />
        <meta name="msapplication-TileImage" content="/assets/images/favicon-270x270.jpg" />

                <script defer data-domain="jrtashjian.com" src="https://plausible.jrtashjian.com/js/plausible.js"></script>
        
        <link rel="stylesheet" href="/assets/build/css/main.css?id=4e5d00fa5633ea52d10317e19903d42b">
        <script defer src="/assets/build/js/main.js?id=70f6d1d6eeef91fcbf04b0be8a530710"></script>

        <link rel="alternate" type="application/rss+xml" title="All Posts by JR Tashjian (The RSS Feed)" href="https://jrtashjian.com/feed.xml" />
    </head>
    <body class="bg-white dark:bg-black text-black dark:text-white font-mono leading-relaxed px-4">
        <div class="mx-auto max-w-prose">

            <header class="flex flex-wrap mb-8 py-8 border-b-8 border-black dark:border-white" role="banner">
                <a href="/" title="JR Tashjian home" class="my-2">
                    <h1 class="font-bold">~/jrtashjian</h1>
                </a>
                <div class="h-card flex ml-auto mr-0">
                    <a href="https://talos.link/@jrtashjian" rel="me" class="u-url inline-flex ml-3 my-2">
                        <svg class="mr-2 fill-current" width="24" height="24" view-box="0 0 24 24" version="1.1">
                            <path d="M23.193 7.879c0-5.206-3.411-6.732-3.411-6.732C18.062.357 15.108.025 12.041 0h-.076c-3.068.025-6.02.357-7.74 1.147 0 0-3.411 1.526-3.411 6.732 0 1.192-.023 2.618.015 4.129.124 5.092.934 10.109 5.641 11.355 2.17.574 4.034.695 5.535.612 2.722-.15 4.25-.972 4.25-.972l-.09-1.975s-1.945.613-4.129.539c-2.165-.074-4.449-.233-4.799-2.891a5.499 5.499 0 0 1-.048-.745s2.125.52 4.817.643c1.646.075 3.19-.097 4.758-.283 3.007-.359 5.625-2.212 5.954-3.905.517-2.665.475-6.507.475-6.507zm-4.024 6.709h-2.497V8.469c0-1.29-.543-1.944-1.628-1.944-1.2 0-1.802.776-1.802 2.312v3.349h-2.483v-3.35c0-1.536-.602-2.312-1.802-2.312-1.085 0-1.628.655-1.628 1.944v6.119H4.832V8.284c0-1.289.328-2.313.987-3.07.68-.758 1.569-1.146 2.674-1.146 1.278 0 2.246.491 2.886 1.474L12 6.585l.622-1.043c.64-.983 1.608-1.474 2.886-1.474 1.104 0 1.994.388 2.674 1.146.658.757.986 1.781.986 3.07v6.304z" />
                        </svg>
                        Mastodon
                    </a>
                    <a href="mailto:hello@jrtashjian.com" class="u-email inline-flex ml-3 my-2">
                        <svg class="mr-2 fill-current" width="24" height="24" view-box="0 0 24 24" version="1.1">
                            <path d="M20,4H4C2.895,4,2,4.895,2,6v12c0,1.105,0.895,2,2,2h16c1.105,0,2-0.895,2-2V6C22,4.895,21.105,4,20,4z M20,8.236l-8,4.882 L4,8.236V6h16V8.236z" />
                        </svg>
                        Email
                    </a>
                </div>
            </header>

            <main role="main">
                	<article class="h-entry">
		<header>
			<h1 class="p-name">Featured Image Fallback for Child Pages</h1>
			<time class="dt-published mr-3" datetime="2017-05-30T20:00:00-04:00" title="Published on May 31, 2017">May 31, 2017</time>
			<a class="p-author h-card sr-only" href="http://jrtashjian.com">JR Tashjian</a>
		</header>

		
		<div class="e-content">
			<p>Continuing from the same project where I needed to <a href="https://jrtashjian.com/2017/05/highlighting-parent-page-in-wordpress-menus/">highlight a parent page in a WordPress menu</a> when on a child page, featured images is another place where I wanted some custom functionality. This custom functionality I'm about to share wasn't necessarily a requirement but I wanted to make it as simple as possible for the client to edit the site easily while still maintaining the design the designer had created.</p>

<p>As I mentioned in the last post the site was designed to have a handful of top-level pages (parents) with an undefined number of related child pages. This site also uses the static front page option in WordPress. The site's layout was a top header navbar, then below that, a featured image with text overlaid, then the page content below that.</p>

<p>What I wanted to do to implement the featured image was to build in a fallback so that we always have a featured image displayed behind the overlaid text. The other option would be to have a different layout where the featured image is not displayed and the page content contains the overlaid text above the actual page content. The fallback is a bit more graceful so I decided to do that.</p>

<p>Below is my solution for this fallback. First, we want to see if the current page has a <code>post_thumbnail</code> (which is our featured image). If the current page returns a <code>post_thumbnail</code> we want to use that. The client should be able to specify an image for any page they want. Now if we don't find a <code>post_thumbnail</code> on the current page I want to check the topmost parent page for it. This would allow the client to set a featured image for an entire group of child pages. And finally, if a <code>post_thumbnail</code> was not returned from the topmost parent page we would then check the defined static front page and pull it from there.</p>

<p>More simply the fallback for the <code>post_thumbnail</code> would be: Child Page -> Parent Page -> Front Page.</p>

<pre><code>&lt;?php

/**
 * Generate markup for the featured image above each page.
 *
 * If a featured image does not exist for the current page we will try and pull one from the parent page. If we still
 * haven't found a featured image we will try and pull one from the 'page_on_front' (when using a static front-page).
 * Otherwise we show nothing.
 */
function featured_image( $size = 'post-thumbnail' )
{
    global $post;

    if ( !is_page() ) {
        return;
    }

    $the_post_thumbnail = get_the_post_thumbnail( $size );

    // Get post_thumbnail from top most parent if we haven't found one yet.
    if ( empty( $the_post_thumbnail ) ) {
        $page_parents   = get_post_ancestors( $post );
        $topmost_parent = array_pop( $page_parents );

        $the_post_thumbnail = get_the_post_thumbnail( $topmost_parent );
    }

    // Get post_thumbnail from "Front Page" template if we still don't find one.
    if ( empty( $the_post_thumbnail ) ) {
        $the_post_thumbnail = get_the_post_thumbnail( get_option( 'page_on_front' ), $size );
    }

    echo $the_post_thumbnail;
}
</code></pre>

<p>It's unlikely we wouldn't find a <code>post_thumbnail</code> like this but we could return a hard-coded default to account for that possibility if we didn't find one on the front page.</p>
		</div>
	</article>
            </main>

            <footer class="flex justify-end mt-8 py-8 border-t-8 border-black dark:border-white" role="contentinfo">
                Copyright (c) 2022 JR Tashjian
            </footer>
        </div>
    </body>
</html>
